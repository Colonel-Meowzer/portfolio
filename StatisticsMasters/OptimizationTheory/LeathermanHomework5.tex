% Created 2020-05-10 Sun 15:33
% Intended LaTeX compiler: pdflatex
\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{longtable}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage{amssymb}
\usepackage{capt-of}
\usepackage{hyperref}
\usepackage{minted}
\author{Dustin Leatherman}
\date{\today}
\title{Homework 5}
\hypersetup{
 pdfauthor={Dustin Leatherman},
 pdftitle={Homework 5},
 pdfkeywords={},
 pdfsubject={},
 pdfcreator={Emacs 26.3 (Org mode 9.4)}, 
 pdflang={English}}
\begin{document}

\maketitle
\tableofcontents


\section{1}
\label{sec:orgf51d399}

\subsection{a}
\label{sec:org1afe779}

\begin{quote}
Change the step size h to 0.03 and run the program. What are the output values
of x and y? After how many iterations?
\end{quote}

[x, y] = [0.12463, 2.97990] after \textbf{495} iterations

\subsection{b}
\label{sec:org48d0443}

\begin{quote}
Change the step size h to 0.01, set \(\epsilon = 0.00005\), set the maximum number
of iterations to be 5000, and run.

What are the output values of x and y? After how many iterations?
\end{quote}


[x, y] = [0.052461, 2.991510] after \textbf{3253} iterations

\subsection{c}
\label{sec:orgd678d79}

\begin{quote}
Modify the program so that it solves for x and y so that

$$
(x - 10)^4 (y - 1)^2 = 0, \ (y - 12)^4 (x - 1)^2 = 0
$$

Do not forget to change the jacobian matrix. Use the initial estimates \([x_0,
y_0] = [11, 11]\).

Use step size \(h = 0.00002\) [note the number of zeros], set \(\epsilon = 0.0004\).

Set the maximum number of iterations to be 80,000 and run.

What are the output values of x and y? After how many iterations?
\end{quote}

\begin{minted}[]{octave}
    Gvect = [(x - 10)^4 * (y - 1)^2, (y - 12)^4 * (x - 1)^2]';

    %%% compute the Jacobian matrix

    Jmat = [4 * (x - 10)^3 * (y - 1)^2, (y - 12)^4 * 2 * (x - 1); (x - 10)^4 * 2 * (y - 1), 4 * (y - 12)^3 * (x - 1)^2];
\end{minted}

[x, y] = [10.111, 11.873] after \textbf{69490} iterations

\section{2}
\label{sec:orge88fe69}

\begin{quote}
Suppose we want to find the minimum value of $$f(x,y) = (x - 1)^4 + (y - 3)^4 +
(x - y)^6$$

Apply the method of steepest descent.

For the initial point, set \(x_0 = y_0 = 10\).

Here \(x_0\) and \(y_0\) are the x and y coordinates of the vector, \(x_0\).

At each iteration k, $$x_{k+1} = x_k - h g_k$$

where \(g_k\) is the gradient vector of \(f\) evaluated at \(x_k\).

Exit the Loop if we reach the max number of iterations or if $$\frac{1}{2}
g_k^T g_k < \epsilon$$

Use the step size \(h = 0.00002\), set \(\epsilon = 0.0004\), and max iterations to 80,000.
\end{quote}


\begin{minted}[]{octave}
h = 0.00002; eps = 0.0004; N = 80000;
x = 10; y = 10;
xvect = [x, y]'
x_and_y = zeros(N,2);

for i = 1:N
  G = [(x - 1)^4 + (y - 3)^4 + (x - y)^6]';
  J = [4 * (x - 1)^3 + 6 * (x - y)^5; 4 * (y - 3)^3 - 6 * (x - y)^5];
  xvect = xvect - h * J;

  x_and_y(i,:) = xvect;
  x = xvect(1);
  y = xvect(2);
 
  Fvalue = 0.5*(J'*J);

  if Fvalue < eps
    break
  end
end

disp('The approximate solution found by Gradient Descent is ');
disp('x = '); disp( x); disp('y = '); disp(y);

disp('Output after '); disp(i); disp(' iterations  is [x, y] = ');
disp(xvect);
\end{minted}

\subsection{a}
\label{sec:org21f66ee}

\begin{quote}
What are the output values of x and y? After how many iterations?
\end{quote}

[x, y] = [1.6494, 2.3586] after 60112 iterations
\subsection{b}
\label{sec:org9d307e0}

\begin{quote}
What is the minimum value of \(f(x,y)\)?
\end{quote}

0.47433
\end{document}
